(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4806aa5e"],{"013f":function(e,s,t){t.r(s);var r=t("7dfd"),i=t("be72"),a=t("7ded"),o=t("2934"),n=t("e487"),c=t("6402"),l=t("658f"),l=t.n(l),c={name:"Login",components:{verify:c.a,vueQr:l.a},data(){return{qrCodeStatus:"success",qrCode:"",qrSessionToken:"",scannerCodeLoginFLag:!1,scannerCodeLoginStatus:0,qrCodeTimer:null,config:t("f121"),type:!0,formData:{username:"",password:""},formSms:{code:"",mobile:""},verifyStatus:!1,ruleInline:{username:[{required:!0,message:"请输入用户名"}],password:[{required:!0,message:"请输入密码"},{type:"string",min:6,message:"密码不能少于6位"}],mobile:[{required:!0,message:"请输入手机号码"},{pattern:r.mobile,message:"请输入正确的手机号"}],code:[{required:!0,message:"请输入手机验证码"}]},codeMsg:"发送验证码",interval:null,time:60,year:(new Date).getFullYear()}},watch:{scannerCodeLoginFLag(e){e||this.clearInterval()}},watch:{scannerCodeLoginFLag(e){e?this.createPCLoginSession():this.clearQRLoginInfo()},type(e){(e?this.$refs.formInline:this.$refs.formSms).resetFields(),this.verifyStatus=!1,this.$refs.verify.show=!1,clearInterval(this.interval),this.codeMsg="发送验证码",this.time=60}},methods:{handleSubmit(e){this.$refs[e].validate(e=>{e&&(this.type?this.$refs.verify.init():(e=JSON.parse(JSON.stringify(this.formSms)),a.h(e).then(e=>{this.$refs.verify.show=!1,e.success?(this.$Message.success("登录成功"),n.a.setItem("accessToken",e.result.accessToken),n.a.setItem("refreshToken",e.result.refreshToken),n.a.setItem("getTimes",0),a.a().then(e=>{e.success&&(n.a.setItem("userInfo",e.result),(e=this.$route.query).rePath?this.$router.push({path:e.rePath,query:JSON.parse(e.query)}):this.$router.push("/"))})):this.$Message.error(e.message)})))})},sendCode(){var e;60===this.time&&(""===this.formSms.mobile?this.$Message.warning("请先填写手机号"):this.verifyStatus?(e={mobile:this.formSms.mobile,verificationEnums:"LOGIN"},Object(o.g)(e).then(e=>{if(e.success){this.$Message.success("验证码发送成功");let e=this;this.interval=setInterval(()=>{e.time--,0===e.time?(e.time=60,e.codeMsg="重新发送",e.verifyStatus=!1,clearInterval(e.interval)):e.codeMsg=e.time},1e3)}else this.$Message.warning(e.message)})):this.$Message.warning("请先完成安全验证"))},verifyChange(e){e.status&&(!0===this.type?((e=JSON.parse(JSON.stringify(this.formData))).password=Object(i.md5)(e.password),this.$refs.verify.show=!1,this.$Spin.show(),a.c(e).then(e=>{e.success?this.loginSuccess(e.result.accessToken,e.result.refreshToken):(this.$Spin.hide(),this.$Message.error(e.message))}).catch(()=>{this.$Spin.hide()})):(this.verifyStatus=!0,this.$refs.verify.show=!1))},verifyBtnClick(){this.verifyStatus||this.$refs.verify.init()},handleWebLogin(e){Object(a.j)(e)},loginSuccess(e,s){this.$Message.success("登录成功"),n.a.setItem("accessToken",e),n.a.setItem("refreshToken",s),a.a().then(e=>{this.$Spin.hide(),e.success&&(n.a.setItem("userInfo",e.result),(e=this.$route.query).rePath?this.$router.push({path:e.rePath,query:JSON.parse(e.query)}):this.$router.push("/"))})},async createPCLoginSession(){Object(a.b)({}).then(e=>{this.clearQRLoginInfo(),200==e.code&&(this.qrCodeStatus="success",e=e.result,this.qrSessionToken=e.token,0===e.status&&(this.qrCode=e.token,this.refreshQrCode()),this.qrLogin())})},async refreshQrCode(){this.qrCodeTimer||(this.qrCodeTimer=setInterval(()=>{this.qrCodeStatus="fail"},1e4))},clearQRLoginInfo(){this.scannerCodeLoginStatus=0,this.qrSessionToken="",this.qrCodeTimer&&clearInterval(this.qrCodeTimer),this.qrCodeTimer=null},async qrLogin(){this.qrSessionToken&&Object(a.g)(this.qrSessionToken,{beforeSessionStatus:this.scannerCodeLoginStatus}).then(e=>{if(e.success)switch(this.scannerCodeLoginStatus=e.result.status,e.result.status){case 0:case 1:this.qrLogin();break;case 2:this.loginSuccess(e.result.token.accessToken,e.result.token.refreshToken);break;case 3:this.createPCLoginSession();break;default:this.clearQRLoginInfo()}else this.clearQRLoginInfo()})}},destroyed(){this.clearQRLoginInfo()},mounted(){var e=this.$route.query.state;e&&(n.a.setItem("uuid",e),Object(a.d)(e).then(e=>{e.success&&this.loginSuccess(e.result.accessToken,e.result.refreshToken)}))}},l=(t("932f"),t("2877")),l=Object(l.a)(c,function(){var s=this,e=s._self._c;return e("div",{staticClass:"login",on:{keyup:function(e){return!e.type.indexOf("key")&&s._k(e.keyCode,"enter",13,e.key,"Enter")?null:s.handleSubmit("formInline")}}},[e("div",{staticClass:"top-content",on:{click:function(e){s.$refs.verify.show=!1}}},[e("div",{staticClass:"logo-box"},[e("img",{attrs:{src:s.$store.state.logoImg},on:{click:function(e){return s.$router.push("/")}}}),e("div",[s._v("欢迎登录")])])]),e("div",{staticClass:"login-container"},[e("Carousel",{staticClass:"login-carousel",attrs:{loop:"","autoplay-speed":5e3,arrow:"never"}},[e("CarouselItem",[e("div",{staticClass:"demo-carousel",on:{click:function(e){s.$refs.verify.show=!1}}},[e("img",{attrs:{src:"https://lili-system.oss-cn-beijing.aliyuncs.com/background.jpg"}})])])],1),e("div",{staticClass:"form-box",on:{click:function(e){s.$refs.verify.show=!1}}},[e("div",{staticClass:"account-number"},[e("div",{staticClass:"tab-switch"},[e("span",[s._v(s._s(s.type?"账号登录":"验证码登录"))]),e("span",{on:{click:function(e){s.type=!s.type,s.scannerCodeLoginFLag=!1}}},[s._v(s._s(s.type?"验证码登录":"账号登录"))])]),e("div",{on:{click:function(e){s.scannerCodeLoginFLag=!s.scannerCodeLoginFLag}}},[s._v(s._s(s.scannerCodeLoginFLag?"返回":"扫码登录"))])]),e("div",{directives:[{name:"show",rawName:"v-show",value:s.scannerCodeLoginFLag,expression:"scannerCodeLoginFLag"}]},[e("div",{staticClass:"qr-container"},[e("div",{directives:[{name:"show",rawName:"v-show",value:"fail"==s.qrCodeStatus,expression:"qrCodeStatus == 'fail'"}],staticClass:"qr-shadow flex"},[e("span",[s._v(" 二维码已失效 ")]),e("Button",{attrs:{size:"small"},on:{click:s.createPCLoginSession}},[s._v("刷新二维码")])],1),e("vue-qr",{attrs:{text:s.qrCode,margin:0,colorDark:"#000",colorLight:"#fff",size:150}})],1),e("div",{staticClass:"drag-area"},[0===s.scannerCodeLoginStatus?e("div",{staticClass:"pending-scan"},[e("p",[s._v("打开手机App/小程序，扫码登录")])]):1===s.scannerCodeLoginStatus?e("div",{staticClass:"scanned"},[e("p",[s._v("扫码成功，等待确认")])]):s._e(),2===s.scannerCodeLoginStatus?e("div",{staticClass:"scanned"},[e("p",[s._v("登录成功，正在页面跳转")])]):3===s.scannerCodeLoginStatus?e("div",{staticClass:"quick-logining"},[e("p",[s._v("取消登录")])]):s._e()])]),e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:!s.scannerCodeLoginFLag,expression:"!scannerCodeLoginFLag"}]},[e("Form",{directives:[{name:"show",rawName:"v-show",value:!0===s.type,expression:"type === true"}],ref:"formInline",attrs:{model:s.formData,rules:s.ruleInline},on:{click:function(e){if(e.target!==e.currentTarget)return null;s.$refs.verify.show=!1}}},[e("FormItem",{attrs:{prop:"username"}},[e("i-input",{attrs:{type:"text",clearable:"",placeholder:"用户名"},model:{value:s.formData.username,callback:function(e){s.$set(s.formData,"username",e)},expression:"formData.username"}},[e("Icon",{attrs:{slot:"prepend",type:"md-person"},slot:"prepend"})],1)],1),e("FormItem",{attrs:{prop:"password"}},[e("i-input",{attrs:{type:"password",clearable:"",placeholder:"密码"},model:{value:s.formData.password,callback:function(e){s.$set(s.formData,"password",e)},expression:"formData.password"}},[e("Icon",{attrs:{slot:"prepend",type:"md-lock"},slot:"prepend"})],1)],1),e("FormItem",[e("Button",{attrs:{type:"error",long:""},on:{click:function(e){return e.stopPropagation(),s.handleSubmit("formInline")}}},[s._v("登录")])],1)],1),e("Form",{directives:[{name:"show",rawName:"v-show",value:!1===s.type,expression:"type === false"}],ref:"formSms",attrs:{model:s.formSms,rules:s.ruleInline},on:{click:function(e){if(e.target!==e.currentTarget)return null;s.$refs.verify.show=!1}}},[e("FormItem",{attrs:{prop:"mobile"}},[e("i-input",{attrs:{type:"text",clearable:"",placeholder:"手机号"},model:{value:s.formSms.mobile,callback:function(e){s.$set(s.formSms,"mobile",e)},expression:"formSms.mobile"}},[e("Icon",{attrs:{slot:"prepend",type:"md-lock"},slot:"prepend"})],1)],1),e("FormItem",{attrs:{prop:"code"}},[e("i-input",{attrs:{type:"text",placeholder:"手机验证码"},model:{value:s.formSms.code,callback:function(e){s.$set(s.formSms,"code",e)},expression:"formSms.code"}},[e("Icon",{staticStyle:{"font-weight":"bold"},attrs:{slot:"prepend",type:"ios-text-outline"},slot:"prepend"}),e("Button",{attrs:{slot:"append"},on:{click:s.sendCode},slot:"append"},[s._v(s._s(s.codeMsg))])],1)],1),e("FormItem",[e("Button",{attrs:{long:"",type:s.verifyStatus?"success":"default"},on:{click:function(e){return e.stopPropagation(),s.verifyBtnClick.apply(null,arguments)}}},[s._v(s._s(s.verifyStatus?"验证通过":"点击完成安全验证")+" ")])],1),e("FormItem",[e("Button",{attrs:{type:"error",long:""},on:{click:function(e){return s.handleSubmit("formSms")}}},[s._v("登录")])],1)],1)],1),e("div",{staticClass:"other"},[e("div",{staticClass:"other-login"},[e("svg",{staticClass:"icon",attrs:{t:"1631154795933",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4969",width:"32",height:"32"},on:{click:function(e){return s.handleWebLogin("QQ")}}},[e("path",{attrs:{d:"M824.8 613.2c-16-51.4-34.4-94.6-62.7-165.3C766.5 262.2 689.3 112 511.5 112 331.7 112 256.2 265.2 261 447.9c-28.4 70.8-46.7 113.7-62.7 165.3-34 109.5-23 154.8-14.6 155.8 18 2.2 70.1-82.4 70.1-82.4 0 49 25.2 112.9 79.8 159-26.4 8.1-85.7 29.9-71.6 53.8 11.4 19.3 196.2 12.3 249.5 6.3 53.3 6 238.1 13 249.5-6.3 14.1-23.8-45.3-45.7-71.6-53.8 54.6-46.2 79.8-110.1 79.8-159 0 0 52.1 84.6 70.1 82.4 8.5-1.1 19.5-46.4-14.5-155.8z","p-id":"4970",fill:"#1296db"}})]),e("svg",{staticClass:"icon",attrs:{t:"1631154766336",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3844",width:"32",height:"32"},on:{click:function(e){return s.handleWebLogin("WECHAT_PC")}}},[e("path",{attrs:{d:"M683.058 364.695c11 0 22 1.016 32.943 1.976C686.564 230.064 538.896 128 370.681 128c-188.104 0.66-342.237 127.793-342.237 289.226 0 93.068 51.379 169.827 136.725 229.256L130.72 748.43l119.796-59.368c42.918 8.395 77.37 16.79 119.742 16.79 11 0 21.46-0.48 31.914-1.442a259.168 259.168 0 0 1-10.455-71.358c0.485-148.002 128.744-268.297 291.403-268.297l-0.06-0.06z m-184.113-91.992c25.99 0 42.913 16.79 42.913 42.575 0 25.188-16.923 42.579-42.913 42.579-25.45 0-51.38-16.85-51.38-42.58 0-25.784 25.93-42.574 51.38-42.574z m-239.544 85.154c-25.384 0-51.374-16.85-51.374-42.58 0-25.784 25.99-42.574 51.374-42.574 25.45 0 42.918 16.79 42.918 42.575 0 25.188-16.924 42.579-42.918 42.579z m736.155 271.655c0-135.647-136.725-246.527-290.983-246.527-162.655 0-290.918 110.88-290.918 246.527 0 136.128 128.263 246.587 290.918 246.587 33.972 0 68.423-8.395 102.818-16.85l93.809 50.973-25.93-84.677c68.907-51.93 120.286-119.815 120.286-196.033z m-385.275-42.58c-16.923 0-34.452-16.79-34.452-34.179 0-16.79 17.529-34.18 34.452-34.18 25.99 0 42.918 16.85 42.918 34.18 0 17.39-16.928 34.18-42.918 34.18z m188.165 0c-16.984 0-33.972-16.79-33.972-34.179 0-16.79 16.927-34.18 33.972-34.18 25.93 0 42.913 16.85 42.913 34.18 0 17.39-16.983 34.18-42.913 34.18z",fill:"#09BB07","p-id":"3845"}})])]),e("div",{staticClass:"register"},[e("span",{staticStyle:{color:"red"},on:{click:function(e){return s.$router.push("signUp")}}},[s._v("还没有账号？点击立即注册")]),e("span",{on:{click:function(e){return s.$router.push("forgetPassword")}}},[s._v("忘记密码")])])])])]),e("verify",{ref:"verify",staticClass:"verify-con",attrs:{verifyType:"LOGIN"},on:{change:s.verifyChange}})],1),e("div",{staticClass:"foot"},[e("Row",{staticClass:"help",attrs:{type:"flex",justify:"space-around"}},[e("router-link",{staticClass:"item",attrs:{to:"/article",target:"_blank"}},[s._v("帮助")]),e("router-link",{staticClass:"item",attrs:{to:"/article?id=1371779927900160000",target:"_blank"}},[s._v("隐私")]),e("router-link",{staticClass:"item",attrs:{to:"/article?id=1371992704333905920",target:"_blank"}},[s._v("条款")])],1),e("Row",{staticClass:"copyright",attrs:{type:"flex",justify:"center"}},[s._v(" Copyright © "+s._s(s.year)+" - Present "),e("a",{staticStyle:{margin:"0 5px"},attrs:{href:"https://pickmall.cn",target:"_blank"}},[s._v(s._s(s.config.title))]),s._v(" 版权所有 ")])],1)])},[],!1,null,"c8581220",null);s.default=l.exports},"5a31":function(e,s,t){},"932f":function(e,s,t){t("5a31")}}]);