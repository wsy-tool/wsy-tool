(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6c88673a"],{1390:function(s,t,e){e("47b4")},"1ddd":function(s,t,e){},"33d2":function(s,t,e){e("b564")},"47b4":function(s,t,e){},7861:function(s,t,e){var i={props:{time:{default:1718977559428},type:{default:"goodsDetail",type:String}},data(){return{end:"",hours:"",minutes:"",seconds:"",interval:""}},mounted(){this.init()},methods:{countDown(s){function t(s){return s<10?"0"+s:s+""}var e=new Date,s=new Date(s),s=parseInt((s.getTime()-e.getTime())/1e3),e=parseInt(s/3600%24),i=parseInt(s/60%60),o=parseInt(s%60),e=t(e),i=t(i),o=t(o);this.hours=e,this.minutes=i,this.seconds=o,s<=0&&(this.end="活动已结束",clearInterval(this.interval))},init(){this.interval=setInterval(()=>{this.countDown(this.time)},1e3)}}},e=(e("1390"),e("2877")),e=Object(e.a)(i,function(){var s=this,t=s._self._c;return t("div",["goodsDetail"===s.type?t("div",{staticClass:"wrapper"},[t("div",{staticClass:"wr-l"},[t("Icon",{attrs:{size:"23",type:"ios-alarm-outline"}}),s._v(" 秒杀活动")],1),""===s.end?t("div",{staticClass:"count-down"},[t("p",[s._v("倒计时：")]),t("span",[s._v(s._s(s.hours))]),t("span",[s._v(s._s(s.minutes))]),t("span",[s._v(s._s(s.seconds))])]):t("div",[s._v(s._s(s.end))])]):t("span",{staticClass:"cart-promotion"},[""===s.end?t("span",[s._v("距活动结束："),t("span",[s._v(s._s(s.hours))]),s._v(" : "),t("span",[s._v(s._s(s.minutes))]),s._v(" : "),t("span",[s._v(s._s(s.seconds))])]):t("span",[s._v("活动已结束")])])])},[],!1,null,"d6d9a094",null);t.a=e.exports},b564:function(s,t,e){},ee17:function(s,t,e){e("1ddd")},f68e:function(s,t,e){e.r(t);var i=e("7861"),o=e("c106"),a=e("2166"),n=e("8194"),o={name:"Cart",beforeRouteEnter(s,t,e){window.scrollTo(0,0),e()},components:{Search:o.a,Promotion:i.a},data(){return{couponAvailable:!1,stepIndex:0,goodsTotal:0,checkedNum:0,allChecked:!1,loading:!1,cartList:[],couponList:[],priceDetailDTO:{},skuList:[]}},methods:{goGoodsDetail(s,t){s=this.$router.resolve({path:"/goodsDetail",query:{skuId:s,goodsId:t}});window.open(s.href,"_blank")},goShopPage(s){s=this.$router.resolve({path:"/Merchant",query:{id:s}});window.open(s.href,"_blank")},collectGoods(s){this.$Modal.confirm({title:"收藏",content:"<p>商品收藏后可在个人中心我的收藏查看</p>",onOk:()=>{n.p("GOODS",s).then(s=>{s.success&&(this.$Message.success("收藏商品成功"),this.getCartList())})},onCancel:()=>{}})},delGoods(s){let t=[];if(s)t.push(s);else{let s=this.cartList;s.forEach(s=>{s.skuList.forEach(s=>{s.checked&&t.push(s.goodsSku.id)})})}this.$Modal.confirm({title:"删除",content:"<p>确定要删除该商品吗？</p>",onOk:()=>{a.h({skuIds:t.toString()}).then(s=>{s.success?(this.$Message.success("删除成功"),this.getCartList()):this.$Message.error(s.message)})}})},clearCart(){this.$Modal.confirm({title:"提示",content:"<p>确定要清空购物车吗？清空后不可恢复</p>",onOk:()=>{a.e().then(s=>{s.success?(this.$Message.success("清空购物车成功"),this.getCartList()):this.$Message.error(s.message)})}})},pay(){this.checkedNum?this.$router.push({path:"/pay",query:{way:"CART"}}):this.$Message.warning("请至少选择一件商品")},showCoupon(s,t){this.couponAvailable=t},changeNum(s,t){s&&a.l({skuId:t,num:s}).then(s=>{s.success&&this.getCartList()})},async changeChecked(s,t,e){s=s?1:0;"all"===t?await a.m({checked:s}):"shop"===t?await a.o({checked:s,storeId:e}):await a.n({checked:s,skuId:e}),this.getCartList()},async receiveShopCoupon(s){var t=await n.Q(s.id);t.success?(this.$set(s,"disabled",!0),this.$Message.success("领取成功")):this.$Message.error(t.message)},async getCartList(){this.loading=!0;try{var s=await a.c();if(this.loading=!1,s.success){this.cartList=s.result.cartList,this.priceDetailDTO=s.result.priceDetailDTO,this.skuList=s.result.skuList;let t=!(this.checkedNum=0);for(let s=0;s<this.cartList.length;s++){var e=this.cartList[s],i=await n.t({storeId:e.storeId});e.couponList.push(...i.result.records)}for(let s=0;s<this.skuList.length;s++)this.skuList[s].checked?this.checkedNum+=this.skuList[s].num:t=!1;this.$forceUpdate(),this.allChecked=t}}catch(s){this.loading=!1}}},mounted(){this.getCartList(),a.b().then(s=>{s.success&&(this.goodsTotal=s.result)})}},i=(e("ee17"),e("33d2"),e("2877")),e=Object(i.a)(o,function(){var i=this,o=i._self._c;return o("div",{staticClass:"cart",on:{click:function(s){i.couponAvailable=!1}}},[o("BaseHeader"),o("div",{staticClass:"width_1200 logo"},[o("div",[o("router-link",{attrs:{to:"/"}},[o("img",{attrs:{src:i.$store.state.logoImg}})]),o("div",[i._v(" 购物车("),o("span",[i._v(i._s(i.goodsTotal))]),i._v(") ")])],1)]),o("Divider"),o("div",{staticClass:"cart-content width_1200 center"},[o("div",{staticClass:"available-area"},[o("div",{staticClass:"cart-steps"},[o("span",{class:0==i.stepIndex?"active":""},[i._v("1.我的购物车")]),o("Icon",{class:0==i.stepIndex?"active-arrow":"",attrs:{custom:"icomoon icon-next"}}),o("span",{class:1==i.stepIndex?"active":""},[i._v("2.填写订单信息")]),o("Icon",{class:1==i.stepIndex?"active-arrow":"",attrs:{custom:"icomoon icon-next"}}),o("span",{class:2==i.stepIndex?"active":""},[i._v("3.成功提交订单")])],1)]),o("div",{staticClass:"cart-goods"},[o("div",{staticClass:"cart-goods-title"},[o("div",{staticClass:"width_60"},[o("Checkbox",{on:{"on-change":function(s){return i.changeChecked(i.allChecked,"all")}},model:{value:i.allChecked,callback:function(s){i.allChecked=s},expression:"allChecked"}},[i._v("全选")])],1),o("div",{staticClass:"goods-title"},[i._v("商品")]),o("div",{staticClass:"width_150"},[i._v("单价（元）")]),o("div",{staticClass:"width_100"},[i._v("数量")]),o("div",{staticClass:"width_150"},[i._v("小计")]),o("div",{staticClass:"width_100"},[i._v("操作")])]),0===i.cartList.length?o("div",{staticClass:"cart-empty"},[o("p",[i._v("购物车空空如也")]),o("router-link",{attrs:{to:"/"}},[i._v("去选购>")])],1):i._l(i.cartList,function(t,e){return o("div",{key:e,staticClass:"cart-goods-items"},[o("div",{staticClass:"shop-name"},[o("div",[o("Checkbox",{on:{"on-change":function(s){return i.changeChecked(t.checked,"shop",t.storeId)}},model:{value:t.checked,callback:function(s){i.$set(t,"checked",s)},expression:"shop.checked"}}),o("span",{staticClass:"go-shop-page",on:{click:function(s){return i.goShopPage(t.storeId)}}},[i._v(i._s(t.storeName))])],1),t.couponList.length?o("span",{staticClass:"shop-coupon",class:i.couponAvailable===e?"shop-coupon-show":"",on:{click:function(s){return s.stopPropagation(),i.showCoupon(t.id,e)}}},[i.couponAvailable===e?o("div",i._l(t.couponList,function(t,s){return o("div",{key:s,staticClass:"coupon-item"},["PRICE"===t.couponType?o("span",[i._v("￥"+i._s(t.price))]):i._e(),"DISCOUNT"===t.couponType?o("span",[i._v(i._s(t.couponDiscount)+"折")]):i._e(),o("span",[i._v("满"+i._s(t.consumeThreshold)+"元可用")]),o("Button",{staticClass:"coupon-btn",attrs:{size:"small",type:"primary",disabled:t.disabled},on:{click:function(s){return i.receiveShopCoupon(t)}}},[i._v(i._s(t.disabled?"已领取":"领取"))])],1)}),0):i._e()]):i._e(),o("div",{staticClass:"promotion-notice"},[i._v(i._s(t.promotionNotice))])]),i._l(t.skuList,function(t,s){return[o("div",{key:s,staticClass:"goods-item"},[o("div",{staticClass:"width_60"},[o("Checkbox",{on:{"on-change":function(s){return i.changeChecked(t.checked,"goods",t.goodsSku.id)}},model:{value:t.checked,callback:function(s){i.$set(t,"checked",s)},expression:"goods.checked"}})],1),o("div",{staticClass:"goods-title",on:{click:function(s){return i.goGoodsDetail(t.goodsSku.id,t.goodsSku.goodsId)}}},[o("img",{attrs:{src:t.goodsSku.thumbnail||"../assets/images/goodsDetail/item-detail-1.jpg"}}),o("div",[o("p",[i._v(" "+i._s(t.goodsSku.goodsName)+" ")]),o("p",["WHOLESALE"===t.goodsSku.salesModel?o("Tag",{staticClass:"goods-show-tag",attrs:{color:"purple"}},[i._v(" 批发商品 ")]):i._e()],1),i._l(t.promotions,function(s,t){return["SECKILL"===s.promotionType?o("div",{key:t,staticClass:"promotion"},[o("span",[i._v("秒杀")]),o("promotion",{attrs:{time:s.endTime,type:"cart"}})],1):i._e()]}),i._l(t.promotions,function(s,t){return["FULL_DISCOUNT"===s.promotionType?o("div",{key:t,staticClass:"promotion"},[o("span",[i._v("满优惠活动")]),o("promotion",{attrs:{time:s.endTime,type:"cart"}})],1):i._e()]})],2)]),o("div",{staticClass:"width_150"},[i._v(" "+i._s(i._f("unitPrice")(t.purchasePrice,"￥"))+" ")]),o("div",{staticClass:"width_100"},[o("InputNumber",{attrs:{min:1,size:"small"},on:{"on-change":function(s){return i.changeNum(t.num,t.goodsSku.id)}},model:{value:t.num,callback:function(s){i.$set(t,"num",s)},expression:"goods.num"}}),o("div",{staticClass:"fontsize_12"},[i._v(" "+i._s(0<t.goodsSku.quantity?"有货":"无货")+" ")])],1),o("div",{staticClass:"width_150"},[i._v(" "+i._s(i._f("unitPrice")(t.subTotal,"￥"))+" ")]),o("div",{staticClass:"width_100"},[t.errorMessage?i._e():o("Button",{attrs:{size:"small",type:"primary"},on:{click:function(s){return i.delGoods(t.goodsSku.id)}}},[i._v("删除")]),t.errorMessage?i._e():o("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"info"},on:{click:function(s){return i.collectGoods(t.goodsSku.id)}}},[i._v("收藏")])],1),t.errorMessage?o("div",{staticClass:"error-goods"},[o("div",{staticStyle:{"margin-top":"20px"}},[i._v(i._s(t.errorMessage))]),o("Button",{attrs:{type:"primary"},on:{click:function(s){return i.delGoods(t.goodsSku.id)}}},[i._v("删除")])],1):i._e()])]})],2)}),o("div",{staticClass:"cart-goods-footer"},[o("div",[o("div",{staticClass:"width_60"},[o("Checkbox",{on:{"on-change":function(s){return i.changeChecked(i.allChecked,"all")}},model:{value:i.allChecked,callback:function(s){i.allChecked=s},expression:"allChecked"}},[i._v("全选")])],1),o("div",{staticClass:"width_100 handle-btn",on:{click:function(s){return i.delGoods()}}},[i._v(" 删除选中商品 ")]),o("div",{staticClass:"width_100 handle-btn",on:{click:i.clearCart}},[i._v(" 清空购物车 ")])]),o("div",[o("div",{staticClass:"selected-count"},[i._v(" 已选择"),o("span",[i._v(i._s(i.checkedNum))]),i._v("件商品 ")]),o("div",{staticClass:"ml_20 save-price"},[i._v(" 已节省"),o("span",[i._v(i._s(i._f("unitPrice")(i.priceDetailDTO.discountPrice,"￥")))])]),o("div",{staticClass:"ml_20 total-price"},[i._v(" 总价（不含运费）: "),o("div",[i._v(i._s(i._f("unitPrice")(i.priceDetailDTO.flowPrice,"￥")))])]),o("div",{staticClass:"pay ml_20",on:{click:i.pay}},[i._v("去结算")])])])],2),i.loading?o("Spin",{attrs:{size:"large",fix:""}}):i._e()],1),o("BaseFooter",{staticClass:"footer"})],1)},[],!1,null,"eb6bea46",null);t.default=e.exports}}]);